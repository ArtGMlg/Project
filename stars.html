<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="./js/loadingScreen.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r119/three.min.js" integrity="sha512-E1+SnTWyHYoY5MN8wpL0SI4TYbpWN12sHXyEViwbzzEyq6GHxQrPFDzEeUDab4emXcf3Yj41Tht2JZnpo3kjwA==" crossorigin="anonymous"></script>
    <script src="./js/Detector.js"></script>
    <script src="./js/AstroControls.js"></script>
    <script src="https://kit.fontawesome.com/60c6536c6a.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="./css/style.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="./css/list.css">
    <title>Звёздное небо</title>
  </head>
  <body>
    <div id="loadingScreen">
      <div id="loadingContent">
        <h3 class="mb-4">Секундочку...</h3>
          <div class="d-flex justify-content-center">
            <img src="./img/anim.gif">
          </div>
        <div class="mt-4 d-flex justify-content-center">
          <div class="progress w-75">
            <div class="progress-bar progress-bar-striped progress-bar-animated" style="width: 100%" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="5">0%</div>
          </div>
        </div>
        <h5 id="phrases" class="mt-3">Это может занять минуту или две :)</h5>
      </div>
    </div>
    <div id="content" class="d-none d-lg-block">
      <div class="labelS">
        <input onclick="collapse()" type="checkbox" name="toggle" id="collapse" class="collapse" disabled="false">
        <label for="collapse" id="collapse-left"><i id="label" class="fas fa-caret-left"></i></label>
      </div>
      <div id="filling">
        <ul id="list">
          <a href="index.html" style="text-decoration: none; color: black;"><li tabindex="0">На главную <i class="fas fa-home"></i></li></a>
          <li tabindex="1" onclick="Inf('ursam')">Малая Медведица</li>
          <li tabindex="2" onclick="Inf('draco')">Дракон</li>
          <li tabindex="3" onclick="Inf('casiopea')">Кассиопея</li>
          <li tabindex="4" onclick="Inf('camelopardus')">Жираф</li>
          <li tabindex="5" onclick="Inf('cepheus')">Цефей</li>
          <li tabindex="6" onclick="Inf('ursaMaj')">Большая Медведица</li>
          <li tabindex="7" onclick="Inf('leoMin')">Малый Лев</li>
          <li tabindex="8" onclick="Inf('canesVinatici')">Гончие Псы</li>
          <li tabindex="9" onclick="Inf('booties')">Волопас</li>
          <li tabindex="10" onclick="Inf('coronaBorealis')">Северная Корона</li>
          <li tabindex="11" onclick="Inf('hercules')">Геркулес</li>
          <li tabindex="12" onclick="Inf('lyra')">Лира</li>
          <li tabindex="13" onclick="Inf('cygnus')">Лебедь</li>
          <li tabindex="14" onclick="Inf('lacerta')">Ящерица</li>
          <li tabindex="15" onclick="Inf('pegasusAndromeda')">Андромеда, Пегас</li>
          <li tabindex="16" onclick="Inf('perseus')">Персей</li>
          <li tabindex="17" onclick="Inf('triangulum')">Треугольник</li>
          <li tabindex="18" onclick="Inf('auriga')">Возничий</li>
          <li tabindex="19" onclick="Inf('gemini')">Близнецы</li>
          <li tabindex="20" onclick="Inf('lynx')">Рысь</li>
        </ul>
      </div>
    </div>
    <div class="modal fade" id="constellationModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title h3" id="exampleModalLabel">Modal title</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body p-4">
          </div>
        </div>
      </div>
    </div>
    <div class="modal fade" id="exampleModalLong" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-scrollable" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle"></h5>
            <button type="button"z style="outline: none;" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div id="myth" class="modal-body">
          </div>
        </div>
      </div>
    </div>
    <div id ="WebGL-output"></div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.0/tween.umd.js" integrity="sha512-czgnkAgPGKmNCtI3dz5iMiR3ScfTBUbqrIIgk13ojVcXkeiS1idg6A37B7xwfqQGecSbPE0pas+NieNgSTfR/g==" crossorigin="anonymous"></script>
    <script src="./js/stars.js"></script>
    <script src="./js/items.js"></script>
    <script>
      var constellations;
      $.ajax({
        url: "https://raw.githubusercontent.com/ArtGMlg/data.json/master/db.json",
        type: 'GET',
        crossDomain: true,
        contentType: 'text/plain; charset=utf-8',
        success: function (data) {
          constellations = JSON.parse(data);
          createConstDivs(constellations)
        }
      });

      function createConstDivs(data){
        for (i = 0; i < data.constellations.length; i++) {
          $('#filling').append(
            "<div class=\"constellation\" id=\"" + data.constellations[i].latName + "\">"+
              "<span>"+
                "<button onclick=\"back()\" type=\"button\" class=\"btn btn-outline-light abs-btn\"><i class=\"fas fa-chevron-left\"></i></button>"+
                "<h2>"+data.constellations[i].name+"</h2>" + 
              "</span>" +
              data.constellations[i].list +
              "<p>"+
                "<button onclick=\"showMyth(\'" +data.constellations[i].latName +"\')\" type=\"button\" class=\"btn btn-light\" data-toggle=\"modal\">"+
                  "Миф" +
                "</button>"+
              "</p>"+
              "<a target=\"_blank\" href=\""+data.constellations[i].link+"\" class=\"btn btn-light\" style=\"width: 60%\" role=\"button\">Обнаруживаем созвездие "+data.constellations[i].name+"</a>"+
            "</div>"
          );
        };
      };

      function showMyth(constname) {
        if (!constellations) {
          $('#exampleModalLongTitle').html("В данный момент невозможно получить данные с сервера.");
          $('#myth').html("Мы уже знаем об этой ошибке и стараемся устранить её.");
          setTimeout(show, 500);
        }else{
          if ($('#constellationModal').hasClass('show')) {
            $('#constellationModal').modal('hide');
          };
          for(i=0; i<constellations.constellations.length; i++){
            if(constellations.constellations[i].latName === constname){
              $('#exampleModalLongTitle').html("Миф о созвездии " + constellations.constellations[i].name);
              $('#myth').html(constellations.constellations[i].description);
              setTimeout(function(){
                $('#exampleModalLong').modal('toggle');
              }, 500);
              break;
            };
          };
          $('#exampleModalLong').on('hidden.bs.modal', function(e){
            if ($(window).width() <= 992) {
              $('#constellationModal').modal('show');
            }
          });
        };
      };
    </script>
  </body>
</html>