<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="./js/three.min.js"></script>
    <script src="./js/Detector.js"></script>
    <script src="./js/OrbitControls.js"></script>
    <link rel="stylesheet" type="text/css" href="./css/style.css">
    <script src="https://kit.fontawesome.com/60c6536c6a.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="./css/list.css">
    <title>Звёздное небо</title>
  </head>
  <body>
    <div id="loadingScreen">
      <div id="loadingContent">
        <h3 style="margin-bottom: 35px">Секундочку...</h3>
        <div class="progress">
          <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="1" aria-valuemin="0" aria-valuemax="1" style="width: 100%">0%</div>
        </div>
        <h5 style="margin-top: 35px">Это может занять минуту или две :)</h5>
      </div>
    </div>
    <div id="content">
      <div id="bgBlur"></div>
      <div class="labelS">
        <input onclick="collapse()" type="checkbox" name="toggle" id="collapse" class="collapse" disabled="false">
        <label for="collapse" id="collapse-left"><i id="label" class="fas fa-caret-left"></i></label>
      </div>
      <div id="filling">
        <ul id="list">
          <a href="index.html" style="text-decoration: none; color: black;"><li tabindex="0">На главную <i class="fas fa-home"></i></li></a>
          <li tabindex="1" onclick="Inf('ursam')">Малая Медведица</li>
          <li tabindex="2" onclick="Inf('draco')">Дракон</li>
          <li tabindex="3" onclick="Inf('casiopea')">Кассиопея</li>
          <li tabindex="4" onclick="Inf('camelopardus')">Жираф</li>
          <li tabindex="5" onclick="Inf('cepheus')">Цефей</li>
          <li tabindex="6" onclick="Inf('ursaMaj')">Большая Медведица</li>
          <li tabindex="7" onclick="Inf('leoMin')">Малый Лев</li>
          <li tabindex="8" onclick="Inf('canesVinatici')">Гончие Псы</li>
          <li tabindex="9" onclick="Inf('booties')">Волопас</li>
          <li tabindex="10" onclick="Inf('coronaBorealis')">Северная Корона</li>
          <li tabindex="11" onclick="Inf('hercules')">Геркулес</li>
          <li tabindex="12" onclick="Inf('lyra')">Лира</li>
          <li tabindex="13" onclick="Inf('cygnus')">Лебедь</li>
          <li tabindex="14" onclick="Inf('lacerta')">Ящерица</li>
          <li tabindex="15" onclick="Inf('pegasusAndromeda')">Андромеда, Пегас</li>
          <li tabindex="16" onclick="Inf('perseus')">Персей</li>
          <li tabindex="17" onclick="Inf('triangulum')">Треугольник</li>
          <li tabindex="18" onclick="Inf('auriga')">Возничий</li>
          <li tabindex="19" onclick="Inf('gemini')">Близнецы</li>
          <li tabindex="20" onclick="Inf('lynx')">Рысь</li>
        </ul>
      </div>
    </div>
    <div class="modal fade" id="exampleModalLong" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle"></h5>
            <button type="button"z style="outline: none;" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div id="myth" class="modal-body">
          </div>
        </div>
      </div>
    </div>
    <div id ="WebGL-output"></div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.0/tween.umd.min.js"></script>
    <script src="./js/stars.js"></script>
    <script src="./js/items.js"></script>
    <script>
      var constData;
      $.ajax({
        url: "http://localhost:5000/constellations/get",
        type: 'GET',
        crossDomain: true,
        dataType: 'jsonp',
        contentType: 'application/json; charset=utf-8',
        success: function (data) {
            constData = data;
            createConstDivs(data);
          }
      });

      function createConstDivs(data){
        for (i = 0; i < data.constellations.length; i++) {
          $('#filling').append(
            "<div class=\"constellation\" id=\"" + data.constellations[i].latName + "\">"+
              "<span>"+
                "<button onclick=\"back()\" type=\"button\" class=\"btn btn-outline-light abs-btn\"><i class=\"fas fa-chevron-left\"></i></button>"+
                "<h2>"+data.constellations[i].name+"</h2>" + 
              "</span>" +
              data.constellations[i].list +
              "<p>"+
                "<button onclick=\"showMyth(\'" +data.constellations[i].latName +"\')\" type=\"button\" class=\"btn btn-light\" data-toggle=\"modal\">"+
                  "Миф" +
                "</button>"+
              "</p>"+
              "<a target=\"_blank\" href=\""+data.constellations[i].link+"\" class=\"btn btn-light\" style=\"width: 60%\" role=\"button\">Обнаруживаем созвездие "+data.constellations[i].name+"</a>"+
            "</div>"
          );
        };
      };

      function showMyth(constname) {
        if (!constData) {
          $('#exampleModalLongTitle').html("В данный момент невозможно получить данные с сервера.");
          $('#myth').html("Мы уже знаем об этой ошибке и стараемся устранить её.");
          setTimeout(show, 500);
        }else{
        for(i=0; i<constData.constellations.length; i++){
          if(constData.constellations[i].latName === constname){
            $('#exampleModalLongTitle').html("Миф о созвездии " + constData.constellations[i].name);
            $('#myth').html(constData.constellations[i].description);
            setTimeout(function(){
              $('#exampleModalLong').modal('toggle');
            }, 500);
            return;
          };
        };
        };
      };
    </script>
  </body>
</html>